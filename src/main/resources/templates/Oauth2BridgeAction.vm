<html>
<head>
    <title>$i18n.getText("oauth2bridge.title")</title>
    $webResourceManager.requireResourcesForContext("com.bes.jira.plugins.oauth2bridge")
    <meta name="decorator" content="atl.admin"/>
    <meta name="admin.active.section" content="admin_plugins_menu/oauth2-bridge-section"/>
    <meta name="admin.active.tab" content="oauth2-bridge-setting-item-link"/>
</head>
<body>

<div class="aui-page-panel">
    <div class="aui-page-panel-content">

        <div class="aui-page-header-main">
            <h1>$i18n.getText("oauth2bridge.title")</h1>
        </div>

        #if($action.hasAnyMessages())
            #if($action.getErrors().size() > 0 || $action.getErrorMessages().size() > 0)
                <div class="aui-message aui-message-error">
                    <p class="title">
                        <strong>$i18n.getText("oauth2bridge.save.error.title")</strong>
                    </p>
                    <ul>
                        #foreach($errorKey in $action.getErrors().keySet())
                            #set($errorMessage = $action.getErrors().get($errorKey))
                            <li>
                                #if($errorKey != "null" && $errorKey != "")
                                    <strong>$errorKey</strong>: $errorMessage
                                #else
                                    $errorMessage
                                #end
                            </li>
                        #end
                        #foreach($errorMessage in $action.getErrorMessages())
                            <li>$errorMessage</li>
                        #end
                    </ul>
                </div>
            #else
                <div class="aui-message aui-message-success">
                    <p class="title">
                        <strong>$action.getMessage()</strong>
                    </p>
                </div>
            #end
        #end

        <form class="aui" method="post">
            <input type="hidden" name="command" value="execute"/>

            <fieldset class="group">
                <legend><span>$i18n.getText("oauth2bridge.fieldset.endpoint"):</span></legend>

                <div class="aui-field-group">
                    <label for="introspectionEndpointId" class="aui-label" title="$i18n.getText('oauth2bridge.introspectionEndpoint.description')">
                        <strong>$i18n.getText("oauth2bridge.introspectionEndpoint"):</strong>
                    </label>
                    <input class="text medium-long-field" type="text" id="introspectionEndpointId" name="introspectionEndpoint" placeholder="$i18n.getText('oauth2bridge.introspectionEndpoint.placeholder')" value="$!action.introspectionEndpoint"/>
                </div>

                <div class="aui-field-group">
                    <label for="baseEndpointId" class="aui-label" title="$i18n.getText('oauth2bridge.baseEndpoint.description')">
                        <strong>$i18n.getText("oauth2bridge.baseEndpoint"):</strong>
                    </label>
                    <input class="text medium-long-field" type="text" id="baseEndpointId" name="baseEndpoint" placeholder="$i18n.getText('oauth2bridge.baseEndpoint.placeholder')" value="$!action.baseEndpoint"/>
                </div>

                <div class="aui-field-group">
                    <label for="invokeEndpointId" class="aui-label" title="$i18n.getText('oauth2bridge.invokeEndpoint.description')">
                        <strong>$i18n.getText("oauth2bridge.invokeEndpoint"):</strong>
                    </label>
                    <input class="text medium-long-field" type="text" id="invokeEndpointId" name="invokeEndpoint" placeholder="$i18n.getText('oauth2bridge.invokeEndpoint.placeholder')" value="$!action.invokeEndpoint"/>
                </div>

                <div class="aui-field-group">
                    <label for="authorizeEndpointId" class="aui-label" title="$i18n.getText('oauth2bridge.authorizeEndpoint.description')">
                        <strong>$i18n.getText("oauth2bridge.authorizeEndpoint"):</strong>
                    </label>
                    <input class="text medium-long-field" type="text" id="authorizeEndpointId" name="authorizeEndpoint" placeholder="$i18n.getText('oauth2bridge.authorizeEndpoint.placeholder')" value="$!action.authorizeEndpoint"/>
                </div>

                <div class="aui-field-group">
                    <label for="clientIdId" class="aui-label" title="$i18n.getText('oauth2bridge.clientId.description')">
                        <strong>$i18n.getText("oauth2bridge.clientId"):</strong>
                    </label>
                    <input class="text medium-long-field" type="text" id="clientIdId" name="clientId" placeholder="$i18n.getText('oauth2bridge.clientId.placeholder')" value="$!action.clientId"/>
                </div>

                <div class="aui-field-group">
                    <label for="clientSecretId" class="aui-label" title="$i18n.getText('oauth2bridge.clientSecret.description')">
                        <strong>$i18n.getText("oauth2bridge.clientSecret"):</strong>
                    </label>
                    <div class="password-input-wrapper">
                        <input class="text medium-long-field" type="password" id="clientSecretId" name="clientSecret" placeholder="$i18n.getText('oauth2bridge.clientSecret.placeholder')" value="$!action.clientSecret"/>
                        <span id="togglePasswordBtn" class="aui-icon aui-icon-small aui-iconfont-view password-toggle-icon" title="Show Password">Show/Hide</span>
                    </div>
                </div>
            </fieldset>

            <fieldset class="group">
                <legend><span>$i18n.getText("oauth2bridge.fieldset.session"):</span></legend>

                <div class="aui-field-group">
                    <label for="sessionTimeoutId" class="aui-label" title="$i18n.getText('oauth2bridge.sessionTimeoutSec.description')">
                        <strong>$i18n.getText("oauth2bridge.sessionTimeoutSec"):</strong>
                    </label>
                    <input class="text short-field" type="number" id="sessionTimeoutId" name="sessionTimeoutSec" min="60" placeholder="$i18n.getText('oauth2bridge.sessionTimeoutSec.placeholder')" value="$!action.sessionTimeoutSec"/>
                </div>
            </fieldset>

            <fieldset class="group">
                <legend><span>$i18n.getText("oauth2bridge.fieldset.tls"):</span></legend>

                <div class="aui-field-group">

                    <label for="insecureSkipVerifyId" class="aui-label" title="$i18n.getText('oauth2bridge.insecureSkipVerify.description')">
                        <strong>$i18n.getText("oauth2bridge.insecureSkipVerify"):</strong>
                    </label>

                    <select class="select" id="insecureSkipVerifyId" name="insecureSkipVerify">

                        <option value="false" #if(!$action.insecureSkipVerify) selected #end>
                            $i18n.getText("oauth2bridge.option.no") </option>

                        <option value="true" #if($action.insecureSkipVerify) selected #end>
                            $i18n.getText("oauth2bridge.option.yes") </option>

                    </select>
                </div>

                <div class="aui-field-group">
                    <label for="trustCaCertId" class="aui-label" title="$i18n.getText('oauth2bridge.trustCaCert.description')">
                        <strong>$i18n.getText("oauth2bridge.trustCaCert"):</strong>
                    </label>
                    <textarea class="textarea full-width-field" id="trustCaCertId" name="trustCaCert" rows="10" placeholder="$i18n.getText('oauth2bridge.trustCaCert.placeholder')">$!action.trustCaCert</textarea>
                </div>
            </fieldset>

            <div class="aui-buttons">
                <input type="submit" class="aui-button aui-button-primary" value="$i18n.getText('oauth2bridge.save.button')"/>
            </div>
        </form>

    </div>
</div>

</body>
</html>